Could be significantly improved. Currently very slow due to lots of overhead. 